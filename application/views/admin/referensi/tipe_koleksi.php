<!DOCTYPE html>
<!-- 
Template Name: Metronic - Responsive Admin Dashboard Template build with Twitter Bootstrap 4
Version: 5.0.5
Author: KeenThemes
Website: http://www.keenthemes.com/
Contact: support@keenthemes.com
Follow: www.twitter.com/keenthemes
Dribbble: www.dribbble.com/keenthemes
Like: www.facebook.com/keenthemes
Purchase: http://themeforest.net/item/metronic-responsive-admin-dashboard-template/4021469?ref=keenthemes
Renew Support: http://themeforest.net/item/metronic-responsive-admin-dashboard-template/4021469?ref=keenthemes
License: You must have a valid license purchased only from themeforest(the above link) in order to legally use the theme for your project.
-->
<html lang="en" >
	<?php echo $header; ?>
				<!-- END: Left Aside -->
				
				<div class="m-grid__item m-grid__item--fluid m-wrapper">
				<div class="m-subheader ">
						<div class="d-flex align-items-center">
							<div class="mr-auto">
								<h3 class="m-subheader__title m-subheader__title--separator">
									<?php echo $title;?>
								</h3>
								<ul class="m-subheader__breadcrumbs m-nav m-nav--inline">
									<li class="m-nav__item m-nav__item--home">
										<a href="#" class="m-nav__link m-nav__link--icon">
											<i class="m-nav__link-icon la la-home"></i>
										</a>
									</li>
									<li class="m-nav__separator">
										-
									</li>
									<li class="m-nav__item">
										<a href="" class="m-nav__link">
											<span class="m-nav__link-text">
												Datatables
											</span>
										</a>
									</li>
									<li class="m-nav__separator">
										-
									</li>
									<li class="m-nav__item">
										<a href="" class="m-nav__link">
											<span class="m-nav__link-text">
												Base
											</span>
										</a>
									</li>
									<li class="m-nav__separator">
										-
									</li>
									<li class="m-nav__item">
										<a href="" class="m-nav__link">
											<span class="m-nav__link-text">
												Local Data
											</span>
										</a>
									</li>
								</ul>
							</div>
							<div>
								<div class="m-dropdown m-dropdown--inline m-dropdown--arrow m-dropdown--align-right m-dropdown--align-push" data-dropdown-toggle="hover" aria-expanded="true">
									<a href="#" class="m-portlet__nav-link btn btn-lg btn-secondary  m-btn m-btn--outline-2x m-btn--air m-btn--icon m-btn--icon-only m-btn--pill  m-dropdown__toggle">
										<i class="la la-plus m--hide"></i>
										<i class="la la-ellipsis-h"></i>
									</a>
									<div class="m-dropdown__wrapper">
										<span class="m-dropdown__arrow m-dropdown__arrow--right m-dropdown__arrow--adjust"></span>
										<div class="m-dropdown__inner">
											<div class="m-dropdown__body">
												<div class="m-dropdown__content">
													<ul class="m-nav">
														<li class="m-nav__section m-nav__section--first m--hide">
															<span class="m-nav__section-text">
																Quick Actions
															</span>
														</li>
														<li class="m-nav__item">
															<a href="" class="m-nav__link">
																<i class="m-nav__link-icon flaticon-share"></i>
																<span class="m-nav__link-text">
																	Activity
																</span>
															</a>
														</li>
														<li class="m-nav__item">
															<a href="" class="m-nav__link">
																<i class="m-nav__link-icon flaticon-chat-1"></i>
																<span class="m-nav__link-text">
																	Messages
																</span>
															</a>
														</li>
														<li class="m-nav__item">
															<a href="" class="m-nav__link">
																<i class="m-nav__link-icon flaticon-info"></i>
																<span class="m-nav__link-text">
																	FAQ
																</span>
															</a>
														</li>
														<li class="m-nav__item">
															<a href="" class="m-nav__link">
																<i class="m-nav__link-icon flaticon-lifebuoy"></i>
																<span class="m-nav__link-text">
																	Support
																</span>
															</a>
														</li>
														<li class="m-nav__separator m-nav__separator--fit"></li>
														<li class="m-nav__item">
															<a href="#" class="btn btn-outline-danger m-btn m-btn--pill m-btn--wide btn-sm">
																Submit
															</a>
														</li>
													</ul>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				<div class="m-content">
						<div class="m-alert m-alert--icon m-alert--air m-alert--square alert alert-dismissible m--margin-bottom-30" role="alert">
							<div class="m-alert__icon">
								<i class="flaticon-exclamation m--font-primary"></i>
							</div>
							<div class="m-alert__text">
								Fungsi GMD: Memberitahu pemustaka sedini mungkin tentang format/bentuk fisik dokumen Mengisyaratkan pada pemustaka bahwa diperlukan alat khusus Menjadi sarana untuk membedakan dokumen dengan judul sama tapi bentuk berbeda Meskipun telah diganti dengan aturan Resource Description and Access (RDA), masih banyak institusi yang menggunakan AACR2 Dalam AACR2 terdapat 2 daftar GMD, daftar pertama digunakan di Inggris, yang kedua digunakan di Amerika Serikat. Indonesia menggunakan daftar kedua.
							</div>
						</div>
						<div class="m-portlet m-portlet--mobile">
							<div class="m-portlet__head">
								<div class="m-portlet__head-caption">
									<div class="m-portlet__head-title">
										<h3 class="m-portlet__head-text">
											Tipe Koleksi
											<small>
												Resource Description and Access
											</small>
										</h3>
									</div>
								</div>
								<div class="m-portlet__head-tools">
									<ul class="m-portlet__nav">
										<li class="m-portlet__nav-item">
											<div class="m-dropdown m-dropdown--inline m-dropdown--arrow m-dropdown--align-right m-dropdown--align-push" data-dropdown-toggle="hover" aria-expanded="true">
												<a href="#" class="m-portlet__nav-link btn btn-lg btn-secondary  m-btn m-btn--icon m-btn--icon-only m-btn--pill  m-dropdown__toggle">
													<i class="la la-ellipsis-h m--font-brand"></i>
												</a>
												<div class="m-dropdown__wrapper">
													<span class="m-dropdown__arrow m-dropdown__arrow--right m-dropdown__arrow--adjust"></span>
													<div class="m-dropdown__inner">
														<div class="m-dropdown__body">
															<div class="m-dropdown__content">
																<ul class="m-nav">
																	<li class="m-nav__section m-nav__section--first">
																		<span class="m-nav__section-text">
																			Quick Actions
																		</span>
																	</li>
																	<li class="m-nav__item">
																		<a href="" class="m-nav__link">
																			<i class="m-nav__link-icon flaticon-share"></i>
																			<span class="m-nav__link-text">
																				Create Post
																			</span>
																		</a>
																	</li>
																	<li class="m-nav__item">
																		<a href="" class="m-nav__link">
																			<i class="m-nav__link-icon flaticon-chat-1"></i>
																			<span class="m-nav__link-text">
																				Send Messages
																			</span>
																		</a>
																	</li>
																	<li class="m-nav__item">
																		<a href="" class="m-nav__link">
																			<i class="m-nav__link-icon flaticon-multimedia-2"></i>
																			<span class="m-nav__link-text">
																				Upload File
																			</span>
																		</a>
																	</li>
																	<li class="m-nav__section">
																		<span class="m-nav__section-text">
																			Useful Links
																		</span>
																	</li>
																	<li class="m-nav__item">
																		<a href="" class="m-nav__link">
																			<i class="m-nav__link-icon flaticon-info"></i>
																			<span class="m-nav__link-text">
																				FAQ
																			</span>
																		</a>
																	</li>
																	<li class="m-nav__item">
																		<a href="" class="m-nav__link">
																			<i class="m-nav__link-icon flaticon-lifebuoy"></i>
																			<span class="m-nav__link-text">
																				Support
																			</span>
																		</a>
																	</li>
																	<li class="m-nav__separator m-nav__separator--fit m--hide"></li>
																	<li class="m-nav__item m--hide">
																		<a href="#" class="btn btn-outline-danger m-btn m-btn--pill m-btn--wide btn-sm">
																			Submit
																		</a>
																	</li>
																</ul>
															</div>
														</div>
													</div>
												</div>
											</div>
										</li>
									</ul>
								</div>
							</div>
							<div class="m-portlet__body">
								<!--begin: Search Form -->
								<div class="m-form m-form--label-align-right m--margin-top-20 m--margin-bottom-30">
									<div class="row align-items-center">
										<div class="col-xl-8 order-2 order-xl-1">
											<div class="form-group m-form__group row align-items-center">
												
												<div class="col-md-6">
													<div class="m-input-icon m-input-icon--left">
														<input type="text" class="form-control m-input" placeholder="Search..." id="generalSearch">
														<span class="m-input-icon__icon m-input-icon__icon--left">
															<span>
																<i class="la la-search"></i>
															</span>
														</span>
													</div>
												</div>
											</div>
										</div>
										<div class="col-xl-4 order-1 order-xl-2 m--align-right">
											<a href="#" class="btn btn-primary m-btn m-btn--custom m-btn--icon m-btn--air m-btn--pill" data-toggle="modal" data-target="#addModal">
												<span>
													<i class="la la-plus-circle"></i>
													<span>
														Tambah data
													</span>
												</span>
											</a>
											<div class="m-separator m-separator--dashed d-xl-none"></div>
										</div>
									</div>
								</div>
								<!--end: Search Form -->
		<!--begin: Datatable -->
								<table class="m-datatable" id="html_table" width="100%">
    								<thead>
										<tr>
											<th title="Field #1">
												No. urut
											</th>
											<th title="Field #2">
												Tipe Koleksi
											</th>
											<th title="Field #3">
												Perubahan Terakhir
											</th>
											<th title="Field #4">
												Aksi
											</th>
										</tr>
    								</thead>
    								<tbody>
									<?php $count = 1; ?>
            						<?php foreach ($koleksi as $t): ?>
                						<tr>
                    						<td><?php echo $count; ?></td>
                    						<td><?php echo $t->tipe_koleksi; ?></td>
                    						<td><?php if($t->last_update !== null){
														echo $t->last_update;
													} else {
													echo $t->input_date;
													}
												?></td>
                    						<td>
                       						 <!-- Tambahkan ikon hapus -->
												<a class="m-portlet__nav-link btn m-btn m-btn--hover-accent m-btn--icon m-btn--icon-only m-btn--pill btnEditTipe" title="Edit" data-id="<?php echo $t->id; ?>">
    											<i class="la la-edit"></i></a>
												<a class="m-portlet__nav-link btn m-btn m-btn--hover-accent m-btn--icon m-btn--icon-only m-btn--pill btnDeleteTipe" title="Delete" data-id="<?php echo $t->id; ?>" data-tipe_koleksi="<?php echo $t->tipe_koleksi ?>">
    											<i class="la la-trash"></i>
												</a>
                    						</td>
                						</tr>
                					<?php $count++; ?>
            						<?php endforeach; ?>
    								</tbody>
								</table>

								<!--end: Datatable -->
							</div>
						</div>
					</div>
				</div>
			
		<!-- application/views/gmd_view.php -->
<!-- ... -->
<div class="modal fade" id="editModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-sm" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Edit Tipe Koleksi</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="editTipeForm" action="<?php echo base_url('admin/referensi/Tipe_koleksi/updateTipe'); ?>" method="post">
				<div class="form-group">
                    <label class="form-control-label">Nama Tipe Koleksi</label>
                    <input type="text" class="form-control" id="tipe_koleksi" name="tipe_koleksi">
                </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="submit" class="btn btn-primary" id="btnUpdateTipe">Update data</button>
                <input type="hidden" id="tipeId" name="tipeId">
            </div>
        </div>
    </div>
</div>
</div>

<!-- Add Modal -->
<div class="modal fade" id="addModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-sm" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Tambah Tipe Koleksi</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-control-label">Nama Tipe Koleksi</label>
                    <input type="text" class="form-control" id="tipe" name="tipe_koleksi">
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary" id="btnAddTipe">Tambah data</button>
            </div>
        </div>
    </div>
</div>



</div>
    </div>
</div>
<!-- ... -->

			<!-- end:: Body -->
<!-- begin::Footer -->
	<?php echo $footer; ?>
	</body>
	<!-- end::Body -->
</html>
<script>
        var baseUrl = '<?php echo base_url(); ?>';
</script>
<script>
//== Class definition
var DatatableHtmlTableDemo = function() {
  //== Private functions

  // demo initializer
  var demo = function() {

    var datatable = $('.m-datatable').mDatatable({
      data: {
        saveState: {cookie: false},
      },
      search: {
        input: $('#generalSearch'),
      },
      columns: [
        {
          field: 'Nama GMD',
          textAlign: 'center'
        },
        {
          field: 'last_update',
          type: 'date',
          format: 'DD-MM-YYYY',
        },
      ],
    });
  };

  return {
    //== Public functions
    init: function() {
      // init dmeo
      demo();
    },
  };
}();
jQuery(document).ready(function() {
  DatatableHtmlTableDemo.init();
});
</script>


<script>
    $(document).ready(function () {
        function handleDelete(id, tipe_koleksi) {
            if (confirm("Apakah Anda yakin ingin menghapus data Tempat [" + tipe_koleksi + "] ini?")) {
                $.post("<?php echo base_url('admin/referensi/Tipe_koleksi/deleteTipe/'); ?>" + id, function (response) {
                    if (response.status === "success") {
                        alert(response.message);
                        location.reload();
                    }
                }, 'json');
            }
        }

		$("#btnAddTipe").click(function (event) { // Add 'event' parameter here
        event.preventDefault(); // Prevent the default form submission
		var tipe_koleksi = $("#tipe").val();

            $.ajax({
                url: "<?php echo base_url('admin/referensi/Tipe_koleksi/addKoleksi'); ?>",
                type: "POST",
                data: {
                    tipe_koleksi : tipe_koleksi
                },
                dataType: "json",
                success: function (response) {
                    if (response.status === 'success') {
                        // Clear form fields
                        $("#tipe").val("");
                        // Close the modal
                        $("#addModal").modal('hide');
                        // Display success message (you can customize this)
						alert(response.message);
						location.reload();
                    } else {
                        // Display error message (you can customize this)
                        alert(response.message);
                    }
                },
                error: function (xhr, status, error) {
                    alert("Terjadi kesalahan saat menghubungi server.");
                }
            });
        });

        // Add event listener to the "Hapus" buttons
        $(document).on('click', '.btnDeleteTipe', function () {
            var id = $(this).data("id");
			var tipe_koleksi = $(this).data("tipe_koleksi");
            handleDelete(id, tipe_koleksi);
        });

        // Additional event listener for the "Edit" buttons
        $(document).on('click', '.btnEditTipe', function () {
            var tipeId = $(this).data('id');

            // AJAX request to fetch GMD data
            $.ajax({
                url: 'Tipe_koleksi/editTipe/' + tipeId,
                type: 'GET',
                dataType: 'json',
                success: function (data) {
                    $('#tipeId').val(data.id);
                    $('#tipe_koleksi').val(data.tipe_koleksi);

                    $('#editModal').modal('show');
                },
                error: function (xhr, status, error) {
                    console.log(error);
                }
            });
        });

        function showUpdateSuccessAlert(message) {
            $("#updateSuccessAlert strong").text(message);
            $("#updateSuccessAlert").show();
        }

        function hideUpdateSuccessAlert() {
            $("#updateSuccessAlert").hide();
        }

        function handleUpdate() {
            var tipeId  = $("#tipeId").val();
            var tipe_koleksi = $("#tipe_koleksi").val();

            $.ajax({
                url: 'Tipe_koleksi/updateTipe',
                type: "post",
                data: {
                    id: tipeId,
                    tipe_koleksi : tipe_koleksi
                },
                dataType: "json",
                success: function (response) {
                    if (response.status === "success") {
                        showUpdateSuccessAlert(response.message);
                        $("#editTipeForm")[0].reset();
                        alert(response.message);
                        location.reload();
                    } else if (response.status === "error") {
                        alert(response.message); // Show error message if needed
                    }
                },
                error: function () {
                    alert("Terjadi kesalahan saat memproses permintaan.");
                }
            });
        }

        $("#btnUpdateTipe").click(function () {
            handleUpdate();
        });
    });
</script>
